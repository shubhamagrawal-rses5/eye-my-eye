// import {ChatGPTAPI} from 'chatgpt';
const express = require("express");
var cors = require('cors')

const app = express();
const port = 5000;

app.use(cors())

app.use(express.json())
app.get("/", (req, res) => {
  res.send("GET request to homepage");
});

app.post("/chat", async (req, res) => {
  const { ChatGPTAPI } = await import("chatgpt");

  const api = new ChatGPTAPI({
    sessionToken: "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..6Ply6sWnPmPr-VqU.8yTTamEmB_Gsh4HINCuWQPvT3NQ5Ev7XaLZ_M3ebH8oNqazBpYu34mNV2LTgxX5619rnqGK4MNmqz3aG0ur2FKFT4Xw41H09JZwQLkAmPFaju6Tsn0Kjc_Wgtj8jFZsPY3mciXK1XcOFCoNxMmqTGVIFMr-Mwo6ay1EwCd0zsnwa163c91VUryuu5Pn2ajVa5fm1hqxlpH5ExpK7pgvVpXpUSIQ5s1QJ-fxfbCJaiglTmVdRjNy8ZKWiD-1q617SpgNqwG-HYBozA9atT8H-gG0QpKfEYBFjra9pidqwsNBo2V8nLzIQkbt3Nx0xCSyPljK2mScwtHkVBxbNizWKDTdn_6JJwDigMtrQERO3SQdUgNTZ0MRseDf8fNP04b32PHCM0WmEzh_nW0hXbL4bSxI0qKDk8-lmEy_MMQjmldIa4-BbRPOmk_Kf5anvTHHMO5HGPGECxVimyhZFn1yphQEamc-Ib9g192Qg_hGoPvJH647qGKNgH1KjuPWvkGYv-Am3d0OOPfEXEjEpBwbGAIvbXh9aPpYcdPnAcWn9YjfukOgYJhlhHii970EOHQRchZtMEAFX0ghEmoFAtD2BJVYcayi34gCyyemTodgO9IB6pdWgkmJ4G-XNcQDEnpv6KusmJ2CkR0Jdj_EraCD-0DHNW4UEsdllpoXCszvrIsbILcwphgfVdk1uKbxU50G2OkPHjoj02yicoiCQAPR3Mfyn8bNrnPf3dtLTG1u3A03cCcAFRlh0tnfJpIZD9iXpTLggPH6TxxgjVQQ83Zk4mR8CEAEjnhW9dAoDb9hQ05scgOviLYpZqs_-CBGtErMtixspdvb6vlCSSY7EU4gvTuqq15ovrUVaR0MdIFJ82GhKgpemAuRPhqLu2paWNG3qWGd5ZaFF7SWgvvc7RpIYMijYye5RFIvdQAMF06pqqBd_6DlNUabDmFOGLhJfCdfWoJlMEjvZF4bnPM2ijP4A9s68aEvkL8S391e5xxkUAYpbdGkcilyNlkOU-t0_SZjGtU9ObSq2VIX09M55uFuvefQ7yRpTCHcfRIIMYzAjlBZ6e6t5GxnKNq6-YCUY1y8E4eAUVr34QqQGhGhPuvuHa6qvfDsF9PDc_pw2jwBiUbby0s_fId7EnVX2BXqJx4UiA96HWfOZuoyI3i-iQ39j7PPCaM6Hf8vkAsHd4lesxuMw_aWkzXbvbDJI2jVICRsHcAtY8zvSsdjPXX16PqtdkFyMdGkligpu2PnFY5Y0n3y9xUIuUyiCztbQcWzuFzvDB5Rw4jSOi1srsRM5FkgsHx6lGDP0jyaWeHFg_9eNtS9yXiG1xCCqeq6cfuOL9NyPJPGcqmRvAf4sR1mHteTACwo6wZD3MAIXja_UMDTtLdvlrpy-5vH0pmGCDuuZhu15CPSABB5bs5DS74zY1-yzV2A_hcbg0dLCuABcLTYmvPURR8Yj-zHWXnjhIFp-hi7m1b8br4IR-88gS7c0gqpRr9z6m6IXeqQjPQF6AGKYIyxJPwSee9BeQUzV-1yAyHDPqw7rwjy1Qwcrn6UwjZ9wzZ54Zjhp6O2oQNz1pdG3wandyzSQaEk8zuwXzovLKJp6FRUQNaGYt6KolyuXBLuJzeRAXIbDeaKaWn6xuqztkSanFF0LJDvF_ZXFrLhmKiB2EIOdhtOVbjJcKSBOR6GRTvhu0QGjlw9hE5HGps0H_rVsbsBIiiskS0rWDtzysL1D4ZlGKukCrA3gUOHGgRn0Lsx8mnCqOb-ujVQJtbtbPpwdLtJbI9_q1GkLv5YtVrOEF1Nm5BL5zVUvnZcG59CJNTZQEjJCYpbRjg3WppPqfaft1SIXgv7fdy_CsSoOKWk1Y4VG7ApZwnGdN7U5D5P1lJRT0K3yvmomh4GHBEtOGp2YNLAUS9u5GPFpXEB592n3W5fN9qifeeQJMoM1OfqYIMCLc7DeJGpbEQCXsPOhp-2Oeh3adSaSDCe_g6iOur3aDokmPzEvSSR06OJ0v70fnEV_RQ4LaW_Qdv1852kj0kd9Hw_9y2Rc5SN36QagezOwmq1pBBJVYgt8hgJMHfNpk4qbSUMTkwJc2i2Lxjkf2G4-ValF2yIHdy2ny5y--YBsEHoQmuXoSGcIxAjZqo-8s6whFPZSEaTFox9V-6QZhL5oeFnM79XupMU8NKz4M6vWKAZLWUifyh-L56sTdKm_wHyfZ2H2f5qAzBEAqRzWsKhzqnzfTviJP6fT8j-ylyvHiApc44tkfcFq5ANDuxs31DyFZdssK6UjRtRSVZTjSRuHYEpvEplZIw.uThCrneLV8xRk0SYHki2Fg",
  });

  await api.ensureAuth();

  const response = await api.sendMessage(req.body.text);
  //  return response;
  // console.log(req.body.text);
  res.json({data:response})
});

app.listen(port, () => {
  console.log(`Example app lis on port ${port}`);
});