// import {ChatGPTAPI} from 'chatgpt';
const express = require("express");
var cors = require('cors')

const app = express();
const port = 5000;

app.use(cors())

app.use(express.json())
app.get("/", (req, res) => {
  res.send("GET request to homepage");
});

app.post("/chat", async (req, res) => {
  const { ChatGPTAPI } = await import("chatgpt");

  const api = new ChatGPTAPI({
    sessionToken: "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..59EutMyS263lTW_B.HH192kCjwSESeWP-VDxK7BcV9nzrqrp_qvUWWMschWuwBr22Bbm6HAJtq2jI1YCvCnePVkjrMkO4XOJrX-typ_rZ1IjYCNAbTpYMyuuIakeCqCiu4gwkY8pKUjW04MrCLkMrnMoVXpNDTI_9X4ZOeLzawRGdbjrp2hY3TtcY-gdCi6ShJVpfbR0GZ8o9Q4QklwYwmew19g-mymrVs-UiqDqUx3pZuGl0p_DTywtS7f9iTs5w1zT5OE231dwmvB9JmX6IJb8buok3VwiLWx8qt2OfiTbiqP0NY0P62y5hEOdJgPUQu2kDy4t0z6PtlXgg8wql0tFA1M432RCLUvMK_JkukFRXd_E6DKeaAwobl4fIbSs9QuUWWcgZSrKpdOp1iynnhblplaI5YVn_ncu8-5nS_5lUzj-UlZaSBPinv925nzVSDxVBfQ_Pmr941IVdd4eF00q8GN3yt4KSEkW1ppCE82bhe93k7cFd77zsXclTRfUkyfflLwHRe2qOPtGVvRON7ksIxSdj7SCjWbuqFSkFKsW51y9WUt8pcM1Jq_zE1d1IU9mgyaxQXBopucIH59yIuJU3N2aiGoZ4h9DP2KW2hZpyXtycU9ZmAcyHaQnwnXEUQStUNVCwSJR5kAqs07DAori692UPaETJ4LgrhUAtcOcMG_-mjNDfFiBcfxzmVTRoRNZU08oWFBQSO3F_rTQfNmm500FcdtMbNnWBvEIwQaFiRpypeIGKqY0Wqh-rveGajIpm4kEiHNoI2dLuB9NspwjXW5YcrsRN4YHbNMoTBEFga0Xj2EJIKmdMpaSR3ldAbo8tjtBIhCARyToNpjekSQaC_zSl9p4pJufo3-7OJZFNbF6emCL1trizpDGZqEOoAcuv6ix1cdAFtJfHjplEag9o2aTvqcKl9-h6xFr4MPdXeXP_6HtaOvt7wlM8qr5rro8QApOerKrrs9subYqhEBJH3uRKdIu6QsnxA2BEoFSSbXtvXidjAIx2dJocuwwk0LFZcRDlMsf4jVEB4tswIQCq4czMl1haBJD5mPRjnyaIsrHnPZ3QvEVskxL78W7oQNwDVoRedXlKPU8SZ6HWQSpdv1pNML7qIvlPGkxcuOs2Kc5vZyKVnwekiI5PMhszqAIyoRsRyxNgTkKhXjfTUlIqEIi_Ft8_mwRTFKjHjY7cxoOIRqH6tC13YcoacG_MUj_LI0DNAMKwNw4Dw_GqIHSUO5wnvGPTAZ6BcfuxZlo2vgMrjYdTvgRA-5cCwALraeCxjVh974gCFQlcd8-tRUO17w8dMFiKAxB-PmY7As6EvwdsqVIno9hmC6MTrJ54oVIHkWBXqOmF94n7FS6DH4dyMsuqyYXmYF2Akz-nDIyv0C6rbel7d2OUf3vwJdMDaPVRqmk7_O9ByIlqiFM6BkT4eas1Bd4MjoY5uqOXR_IH823qHQ76gpJHc65BUItc6E-WMXP9LyApAGHnBE83JJgUb16QYbnedHNt4LVjQD3HvQBaVKaMQ95a23HWvuhCT8rGcav7J9EhH1RkAzGlXbeMcRDuWhcQMpU7CWePhxoqU1Q1_JAcqsH8AITIwBqmI-AKIj08aez0AIBCAfY5C0txdiCPdNz3Aa8smY5hB2meRjbkFXoPBhQUMN2FmNJuR-SOVZYRv8sPqwh7dIImxzSp2ubWV8UVHZgAbyhqqbKvXA3qmX6B0zUOqqWORfFmWioLMKFXRAkEAmHY6IypLstE8o-VlcaDNJpmb6h22tdHnba1CUNdF9elld-o0nOpVx3ZyG5APGxTL1IMSfXVlY0YMcdFLrn-6nbAlYCM3YF3Ce4sil-13FQpVR3miPf_S7PKzsO6vNBWF7aJU-9lY37vC5p6CCEEmJiLFYLURsWWPBkx0h1Qm9aJDSA4alpKXv76tkx6-S06rYq7QAaxSbnS90ggodiNWRtT4AqNAcLoSHTXlMjerYNjnlVaFefMALxSgDR8OF6i8NEwi_uKKzf-OwXxDGscQKpsFWXimv931Q_PBTceYTU9tAl0DvmXvE_QVInFZYPI4ArLfvLfIFGX5A2AEMXcu_2JFn4u-ZQhRDHgbKaHceFuB6118DJSNtiu-W5jllLAWEO4Q6aqQfxPEdGnZTmogmlQkhOiT_NLcC9uA1zGk7yjGpMvFh1JOszvfNJvbRTjJYnEziL0vxdDKV_0C5_LozZ_u8eSadS3JpxytvLUYmjMbL-1uTsGGgyzX9Z-a5G-EZGuAIYFwVUj310eMf0vJNGm9MI0TsD9J6cO1XX8kROYoL8UPACEPzOa358tXJ7CPYry.8n6ejEBzuVp7Vm3KjG3v5A",
  });
  await api.ensureAuth();

  const response = await api.sendMessage(req.body.text);
  //  return response;
  // console.log(req.body.text);
  res.json({data:response})
});

app.listen(port, () => {
  console.log(`Example app lis on port ${port}`);
});