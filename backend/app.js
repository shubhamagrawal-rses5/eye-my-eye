// import {ChatGPTAPI} from 'chatgpt';
const express = require("express");

const app = express();
const port = 4000;

async function main() {

  const {ChatGPTAPI} = await import("chatgpt");

  const api = new ChatGPTAPI({
    sessionToken: "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..EAGwfiQ9lrci6IT5.e4JQzvPzP0g3txa-REOEimlr7te4hGm4VJgNU3lynsE7mHM7O3smMzyA0MqsT7I1HJ5N4x1nxm6j3TeFN9wlqIEY27VrWBppN0k0ypi9GlkJQ9V1sSqjIawkTfmW16mx8maP7X-TL1ZjtrkgnHGVD52zVGappAMfTXOBdJ-I4ebi_zZVcRaBMjGj_7z7rUee5tuxZCwJ0VvkeqsWLE0RltsmEABeJryBCPqxnGW3spLwVWFi6uykhnYfMWszQO42tqB3-SFxnWjuDb_1ROK_8q8Fd1ZrMjy2CzRurc_blG4TC2X9GHq10ZGhVSNWWOqCUl3ixrusDO8P-nX36eKlZGC9urejX-ioxwPmWcGjBaJ7PHlT4qyD2a4XZXJc1BS2ihRjmmELuPZYApMszhVWMXHgoEuaKauzsqmv0SdMH0ihYZcZ9RltcLdpMZiCe0tq66WIKDgTVZG5kbjR0RKqFjco3qpj98obI6PExxLjrEsYTr8X_F5QZ-v81uKFdiFyFIwBtX5tURfKB4LCiJAzNBSNGShEKkAhvQRbgaA1HZx6TZXos_d2NQCuJtgQ2FE_u3G0NkpU-YFT_zIiCQMb_WIMf5DCxxT64hu3kmL0rRBZW4RBzskzGAsUqdV9Et5zzuyzyzRmqmX1hk5fG1-WYgptTlFf8h7rGJy6i63OhrCqc9I14C8b0hugciRZ00HbqhdqVTiUOmvPmAITmvp1a6Nqv9Jemn0O1gN5_o9c3yU7fdcBZrnNUklGnyc5uSdE7-VTpGuxMoq2Lz2Lp8ivLiU8e-eQYxWORjW8hpKSIJaCOonW0M1VzWw_ZI2QrI_zKJpp3ZVFNyv-wA004-upnO80qu6kK6crSHnVJHzbswoysGmVRSRG0dYmAvEZ0vOK45Hu9V_elZfV5tLDA7UhyO1PxjDeTF_bu67MhRVzzhy2NP8taeci-_HErLi_hEk3gsVZ8o88ny40NQyR5OA9nMoOdzc9q39wveMUaV9qOck-N-kIrXDYoy8sAuy64yJySKfwtnKtXCWzzVqgwPy4TvSv-Q7EU_1UBYuhXSSWBDmXt6rYiTSTsUBOtrzVM6rHn9R8gSfTpidaGGZEHcVmMDuhN8iLzYr8U2J6ISvz3qUGhv9-i95xhafnelikjndA1eLPHi-GEnjXEo5yfd-2jNgSwCKZz6nWfZaRBkYIxqo3FHc0xqZceVYOXdVckyO9PMsXY-hEesBeO9nLDdY6D8xPLF6YsRq1H65ic-3YxeDWyXOebCnZVro9tFz2lieBaJW4zNg8jq7LO1OB5MJTWqEHUt1B3_N0xqlrcG8DafALrNm9pPL7tHFuK90sgNIfJqs8t_lWsb9mpy_5iBYK56zmyO4r2TGENEkWgILfK4gTpHNMJ0czSfgz2_k2645ch12hb8EuTbyOlefxH7tJdmN9QUfU9EvCeHQNFgwsQqGeLo8WYZOV9TuTPtabfDP9zK67k0mYJCSp6_0b4SLw-Tp1GUOnocbI93mPl96T5aUuISN-VjljvuJopyJ-CdMN0ba6SkuAuko4HlGRwoMOqWNK4_2EKU1Yq1gBA9-GnUevh8thW3c3VGeUIboM54UjfIgWz9mB1yhjFIvja9b0TlkZUD8aFOZnoMw9R4XglcAwnHxLHCUWrEGZU82iuD7lFpMWpACkar24-qVthocGVPIXwLZNxHaL809Iz04AqY3gJzBM1agiVv51yHMHLSSFOre4HtugwKuJItmbZPKFjsk6LCR_Dr2MJ6Xf48o5JOZb9KPXjmtQMapPmQy82tBV2AMtlcwfFLze5uiEmj2SUGut40Ro__UC2E9gonp5fUbD9r3YUbql-cVjwHCJONaoTGEAA_kGkRTqBSRTRlKJqSLCWFrzKGI93aICmlMdvSzymR6bRIserjhBICr2YUfCHGqCRpd5Ze5dqCV1V4gK7AZZ6oHAiEhLOfE9CnWTdt74qcalgiCG_Qfels7ikf-0pNrQAAZgQyGSCoIwQ37U9qCuH0WfJjj0i6ebOpc0n91_ZPSeXYjDLI_JqM8vanRqvoAaGETHcIyaZMwUiEo-pZgCspeibaSzyqN7xp3iQGhLSX_fMEqiLIi6Y4GyVLfrc1F6G6EPDC6tVGC9AJSvAnf0f-HSf3orxkFI-mPIj0s84ymKs4ILF1nki-gXmzYJbxxmp-yD0QxVxjd8kDv-65ZipPz7a879D4TZ8M1glQ4TYxwprAgRi7LQfN4rLv5EFwKlccxMESu-SWvzGrF0wHMC9YI-0iiITQHEfVeN5jSpVUvobDt5vQ.hKzRHSVAJLeZP7qYvOqoRg"
  });

  await api.ensureAuth();

  const response = api.sendMessage(
    "Write a python version of bubble sort.");
  //  return response;
  console.log(response);
}

app.get("/", (req, res) => {
  res.send('GET request to homepage');
  main()
});

app.listen(port, () => {
  console.log(`Example app lis on port ${port}`);
});